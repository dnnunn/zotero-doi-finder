<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>DOI Finder Preferences</title>
    <style>
        body {
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }
        
        .pref-group {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            background: #f9f9f9;
        }
        
        .pref-group h2 {
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 16px;
            color: #333;
        }
        
        .pref-item {
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .pref-item label {
            flex: 1;
            font-size: 14px;
        }
        
        .pref-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }
        
        .pref-item input[type="number"] {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        
        .about-section {
            margin-top: 30px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 5px;
            text-align: center;
        }
        
        .about-section p {
            margin: 5px 0;
            font-size: 14px;
            color: #666;
        }
        
        button {
            padding: 8px 16px;
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 14px;
        }
        
        button:hover {
            background: #005fa3;
        }
        
        button:active {
            background: #004b87;
        }
    </style>
</head>
<body>
    <div class="pref-group">
        <h2 data-l10n-id="doifinder-prefs-title"></h2>
        
        <div class="pref-item">
            <input type="checkbox" 
                   id="pref-autoFind" 
                   preference="extensions.zotero.doifinder.autoFind"
                   data-preference-default="false" />
            <label for="pref-autoFind" data-l10n-id="doifinder-prefs-autoFind"></label>
        </div>
        
        <div class="pref-item">
            <label for="pref-rateLimit" data-l10n-id="doifinder-prefs-rateLimit"></label>
            <input type="number" 
                   id="pref-rateLimit" 
                   preference="extensions.zotero.doifinder.rateLimit"
                   data-preference-default="300"
                   min="100"
                   max="5000"
                   step="100" />
        </div>
        
        <div class="pref-item">
            <input type="checkbox" 
                   id="pref-checkSimilarity" 
                   preference="extensions.zotero.doifinder.checkSimilarity"
                   data-preference-default="true" />
            <label for="pref-checkSimilarity" data-l10n-id="doifinder-prefs-checkSimilarity"></label>
        </div>
        
        <div class="pref-item">
            <label for="pref-similarityThreshold" data-l10n-id="doifinder-prefs-similarityThreshold"></label>
            <input type="number" 
                   id="pref-similarityThreshold" 
                   preference="extensions.zotero.doifinder.similarityThreshold"
                   data-preference-default="0.85"
                   min="0.5"
                   max="1.0"
                   step="0.05" />
        </div>
    </div>
    
    <div class="about-section">
        <h2 data-l10n-id="doifinder-prefs-about"></h2>
        <p data-l10n-id="doifinder-prefs-version" data-l10n-args='{"version": "0.0.1"}'></p>
        <p data-l10n-id="doifinder-prefs-developer"></p>
    </div>
    
    <script>
        // Initialize preferences
        document.querySelectorAll('[preference]').forEach(elem => {
            const prefKey = elem.getAttribute('preference');
            const defaultValue = elem.getAttribute('data-preference-default');
            
            if (elem.type === 'checkbox') {
                elem.checked = Zotero.Prefs.get(prefKey, defaultValue === 'true');
                elem.addEventListener('change', () => {
                    Zotero.Prefs.set(prefKey, elem.checked);
                });
            } else if (elem.type === 'number') {
                elem.value = Zotero.Prefs.get(prefKey, parseFloat(defaultValue));
                elem.addEventListener('change', () => {
                    Zotero.Prefs.set(prefKey, parseFloat(elem.value));
                });
            }
        });
        
        // Load localization
        document.querySelectorAll('[data-l10n-id]').forEach(elem => {
            const l10nId = elem.getAttribute('data-l10n-id');
            const l10nArgs = elem.getAttribute('data-l10n-args');
            
            try {
                if (l10nArgs) {
                    elem.textContent = Zotero.Intl.formatValueSync(l10nId, JSON.parse(l10nArgs));
                } else {
                    elem.textContent = Zotero.Intl.formatValueSync(l10nId);
                }
            } catch (e) {
                // Fallback text
                elem.textContent = l10nId.replace('doifinder-prefs-', '').replace(/-/g, ' ');
            }
        });
    </script>
</body>
</html>